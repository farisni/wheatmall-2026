# AI 操作规则 (AI Operating Rules)

本文档记录了与 AI 助手协作时的操作规范和规则。

## 核心规则

### 1. 测试验证规则

**规则描述：**
每次完成用户提出的需求后，必须执行测试验证，确保代码正确性。

**具体操作：**
1. 需求完成后，运行命令：`mvnd test`（或 `mvn test`，视环境而定）
2. 等待所有测试执行完毕
3. **仅当所有测试通过后**，才向用户报告成功
4. 如果有测试失败，必须修复后才能报告完成

**示例流程：**
```
用户提出需求 → AI实现需求 → 运行 mvnd test → 全部通过 → 报告成功
                                    ↓
                              有失败 → 修复问题 → 重新测试 → 通过 → 报告成功
```

### 2. Git 提交规则

**规则描述：**
未经用户明确要求，不得擅自执行 `git commit` 和 `git push` 操作。

**具体操作：**
- **只有在用户明确要求时，才能执行 `git commit`**
- **只有在用户明确说"push"或"推送"时，才能执行 `git push`**
- 完成需求后，先报告完成情况，询问用户是否需要提交
- 告知用户哪些文件发生了变更，等待用户确认后再提交

### 3. 文档记录规则

**规则描述：**
每次完成需求后，必须在 README.md 中记录本次工作内容，确保项目文档不丢失。

**具体要求：**
- 在 README.md 的 `## 开发记录` 部分添加新条目
- 记录日期、需求标题、主要修改内容
- 不需要非常详细，但要能清楚知道做了什么
- 包括：修改了哪些文件、添加了什么功能、重要配置变更等

**示例格式：**
```markdown
### 2024-02-17: 添加XXX功能

**修改内容：**
- 添加/修改了某个功能
- 主要变更文件：
  - `backend/xxx/pom.xml` - 添加依赖
  - `backend/xxx/Xxx.java` - 实现功能
```

### 4. 需求拆分和步骤记录规则

**规则描述：**
接到用户需求后，先将其拆分为多个可执行的步骤，并记录大致的执行计划。

**具体操作：**
1. 分析需求，拆分成逻辑清晰的若干步骤
2. 在 README.md 的 `## 开发记录` 中记录需求标题和拆分后的步骤
3. 每完成一个步骤，在对应步骤后标记完成状态
4. 如遇到需求变更或步骤调整，及时更新记录

**示例格式：**
```markdown
### 2024-02-17: 实现XXX功能

**执行步骤：**
1. [x] 分析需求，确定技术方案
2. [x] 添加相关依赖
3. [x] 实现核心功能代码
4. [x] 编写单元测试
5. [x] 运行测试验证
6. [ ] 更新文档（待完成）

**主要变更：**
- 添加/修改了某个功能
```

**注意事项：**
- 步骤不需要过于详细，但要能反映整体工作流程
- 使用 `[x]` 标记已完成，`[ ]` 标记未完成
- 复杂的子任务可以进一步拆分
- **README.md 记录大致步骤，auth-admin-plan.md 等详细文档记录细节步骤，但也不是事无巨细**

## 技术栈特定规则

### Maven 项目
- 优先使用 `mvnd`（Maven Daemon）进行构建和测试，速度更快
- 如果 `mvnd` 不可用，则使用 `mvn`
- 测试命令：`mvnd test` 或 `mvn test`

### Spring Boot 项目
- 修改代码后必须验证编译是否通过
- 新增依赖后必须验证依赖是否正确引入
- 单元测试使用 JUnit 5 + Mockito

### Java 对象命名规范

| 缩写 | 全称 | 中文含义 | 使用场景 | 说明 |
|------|------|----------|----------|------|
| DTO | Data Transfer Object | 数据传输对象 | Service ↔ Controller | 层间数据传输 |
| VO | View Object | 视图对象 | Controller ↔ 前端 | 返回给前端展示 |
| DO/PO | Domain/Persistent Object | 领域/持久化对象 | DAO ↔ Database | 数据库表映射 |
| BO | Business Object | 业务对象 | Service 层 | 封装业务逻辑 |
| Query | Query Object | 查询对象 | Controller → Service | 封装查询参数 |
| POJO | Plain Old Java Object | 简单Java对象 | 任意 | 普通Java对象 |

**使用原则：**
- Controller 返回前端统一使用 VO
- Service 层接收参数使用 DTO 或 Query
- 与数据库交互使用 DO/PO
- 复杂业务逻辑封装在 BO 中

## 沟通规范

### 测试报告格式
测试成功后，应按以下格式报告：

```
**测试成功！** ✅

**测试结果：**
- 模块A: X个测试通过
- 模块B: Y个测试通过
- **共计：Z个测试，全部通过** ✓
```

### 完成确认
需求完成后应询问用户是否需要：
1. 提交代码（git commit）
2. 推送代码（git push）- **必须等待用户明确同意**
3. 其他后续操作

## 更新记录

| 日期 | 更新内容 | 更新人 |
|------|----------|--------|
| 2024-02-17 | 初始版本，添加测试验证规则、Git提交规则 | AI Assistant |
| 2024-02-17 | 添加文档记录规则 | AI Assistant |
| 2024-02-17 | 添加需求拆分和步骤记录规则 | AI Assistant |
| 2024-02-17 | 添加Java对象命名规范 | AI Assistant |

---

**注意：** 本文档由 AI 助手维护，如有新的规则需求，请告知 AI 助手更新此文档。
